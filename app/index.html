<!DOCTYPE html>
<html>
<head>
  <title>Perl Maven's view of CPAN</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/3.0.2/handlebars.min.js"></script>
  <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
  <script src="/metacpan.js"></script>
  <script src="/recommended.js"></script>

  <link rel="stylesheet" href="/style.css">

<script id="error-template" type="text/x-handlebars-template">
  Error. {{code}}
</script>

<script id="release-template" type="text/x-handlebars-template">
  <div class="entry">
    <h2><a href="#/author/{{result.author}}">{{result.author}}</a> {{result.name}} {{result.date}}</h2>
    <a href="https://metacpan.org/release/{{result.distribution}}" target="_blank">MetaCPAN</a>
  </div>
  <div class="repository">
    <a target="_blank" href="{{result.resources.repository.web}}">{{result.resources.repository.type}}</a>
  </div>

  {{#unless result.authorized}}
    <div class="warn">Unauthorized release</div>
  {{/unless}}

  <div class="license">
     License: {{result.license}}
  </div>

  <h2>Provides</h2>
  {{#each result.provides}}
      <a href="#module/{{this}}">{{this}}</a><br>
  {{/each}}
</script>

<script id="module-template" type="text/x-handlebars-template">
    <h2><a href="#release/{{result.distribution}}">{{result.distribution}}</a> {{query}} {{result.version}} by <a href="#author/{{result.author}}">{{result.author}}</a></h2>
    {{result.abstract}}
    <hr>
    <ul>
    {{#each result.module}}
       <li>{{name}} {{#if version}}{{version}}{{/if}} {{#if associated_pod}}{{associated_pod}}{{/if}}</li>
    {{/each}}
    </ul>
    <hr>
    {{#unless result.authorized}}
     <div class="warn">Unauthorized release</div>
    {{/unless}}
    {{result.release}}<br>
    {{result.path}}<br>
    <div>
     {{result.description}}
    </div>
    <hr>
    <div>
     {{result.pod}}
    </div>
</script>

<script id="home-template" type="text/x-handlebars-template">
  <h2>Perl Maven's view of CPAN</h2>
  <ul>
  {{#each result.recommended}}
     <li><a href="#recommended/{{@key}}">{{@key}}</a></li>
  {{/each}}
  </ul>
  If you would like to suggest other categories, you can do that via <a target="_blank" href="https://github.com/szabgab/metacpanjs">GitHub</a>
</script>

<script id="recommended-template" type="text/x-handlebars-template">
  <h2>Perl Maven's recommended CPAN modules for {{query}}</h2>
  <ul>
  {{#each result.recommended}}
     <li><a href="#module/{{this}}">{{this}}</a></li>
  {{/each}}
  </ul>
</script>



<script id="recent-template" type="text/x-handlebars-template">
  <ul>
    {{#each result.hits.hits}}
      <li>
        <a href="#release/{{fields.distribution}}">{{fields.name}}</a><br>
        {{fields.abstract}}<br>
        {{fields.date}}<br>
        {{#iff fields.status '!=' 'latest'}}<b>{{fields.status}}</b>{{/iff}}<br>
      </li>
    {{/each}}
  </ul>

</script>


<script id="author-template" type="text/x-handlebars-template">
  <h2>{{result.name}} ({{result.pauseid}})</h2>
  <img src="{{result.gravatar_url}}" alt="{{result.name}}" /><br>
  {{#each result.website}}
    <a target="_blank" href="{{this}}">{{this}}</a><br>
  {{/each}}
  <a href="https://metacpan.org/author/{{result.pauseid}}" target="_blank">MetaCPAN</a>
  
  {{#if result.profile}}
    <h3>Profiles</h3>
    {{#each result.profile}}
       {{#if url}}
          <a target="_blank" href="{{url}}" title="{{name}}"><img src="https://metacpan.org/static/images/profile/{{name}}.png" /></a>
       {{else}}
          {{name}} {{id}}<br>
       {{/if}}
    {{/each}}
  {{/if}}

  {{#if result.blog}}
    <h3>Blog</h3>
    {{#each result.blog}}
       <a target="_blank" href="{{url}}">{{url}}</a> <a target="_blank" href="{{feed}}">feed</a><br>
    {{/each}}
  {{/if}}
</script>

<script id="releases-template" type="text/x-handlebars-template">
   <h2>Recent releases without a license</h2>
   <ul>
   {{#each result}}
     <li><a href="#release/{{fields.distribution}}">{{fields.distribution}}</a></li>
   {{/each}}
   </ul>
</script>

<script id="other-template" type="text/x-handlebars-template">
  <h2>Various other pages</h2>
  <ul>
    <li><a href="#no-license">no license</a></li>
  </ul>
</script>

<script id="leaderboard-template" type="text/x-handlebars-template">
  <h2>Leaderboard - Authors with Most Uploads</h2>
  Total: {{result.facets.author.total}}
  <ul>
  {{#each result.facets.author.terms }}
    <li><a href="#author/{{term}}" >{{term}}</a> {{count}}</li>
  {{/each}}
  </ul>

  {{sizer}}
  {{pager}}
</script>

<script id="profiles-template" type="text/x-handlebars-template">
   <h2>Profile fields</h2>
   <ul>
   {{#each result.profiles}}
     <li><a href="#profile/{{@key}}">{{@key}}</a></li>
   {{/each}}
   </ul>
</script>

<script id="profile-template" type="text/x-handlebars-template">
   <h2>Users with {{query}} in their profile</h2>
   <ul>
     {{#each result.hits.hits}}
       <li><a href="#author/{{this.fields.pauseid}}">{{this.fields.name}} ({{this.fields.pauseid}})</a> <a href="{{this.url}}" target="_blank">{{../query}}</a></li>
     {{/each}}
   </ul>

  {{sizer}}
  {{pager}}
</script>


</head>
<body>

<nav class="navbar">
    <ul>
        <li><a href="#">home</a></li>
        <li><a href="#recent">recent</a></li>
        <li><a href="#leaderboard">leaderboard</a></li>
        <li><a href="#profiles">profiles</a></li>
        <li><a href="#other">other</a></li>
        <li><a target="_blank" href="https://github.com/szabgab/metacpanjs">fork me</a></li>
    </ul>
</nav>

<p>Find a solution in Perl (For now, search only works if you type the exact name of a distribution. For example Test-Simple. Use the other navigaion options)</p>
<p><input type="text" id="query"><button id="search">Search</button></p>
<hr>

<div id="result">
</div>


</body>
</html>

